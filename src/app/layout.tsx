// These styles apply to every route in the application
import './globals.css'
import type { Metadata } from 'next'
import { Inter } from 'next/font/google'
import { SessionProvider } from 'next-auth/react'
import AuthContext from './AuthContext'
import { Session, getServerSession } from 'next-auth'
import { authOptions } from './api/auth/[...nextauth]/route'
import NavBar from '@/components/navbar'
import { Suspense } from 'react'
import { ThemeProvider } from 'next-themes';
import NextThemeProvider from './next-theme-provider'
import { AppContextProvider } from '@/context/app'

const inter = Inter({ subsets: ['latin'] })

export const metadata: Metadata = {
  title: 'Ryder Truck repair',
  description: 'Generated by create next app',
}


async function getSession(cookie: string): Promise<Session> {
  const response = await fetch(`${process.env.AUTH0_BASE_URL}/api/auth/session`, {
    headers: {
      cookie,
    },
  });

  const session = await response.json();

  return Object.keys(session).length > 0 ? session : null;
}

export default async function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  //const session = await getSession(headers().get('cookie') ?? '');
  const session = await getServerSession(authOptions);
  const setBlur = (show: boolean, c: any) => {

  }
  return (
    <html lang="en">

          <body className={`${inter.className} min-h-full`}>

            {/* <div className="min-h-full"> */}
            
          <NavBar   />
          {/* <ClientLanding >{children}</ClientLanding> */}
              {/* <AuthContext session={session!}> */}
              <AppContextProvider>
                <Suspense>
        {/* </AuthContext> */}
        {children}
            </Suspense>
            {/* </div> */}
            </AppContextProvider>
        
      </body>
    </html>
  )
}
